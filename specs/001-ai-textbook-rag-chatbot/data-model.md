# Data Model: AI Physical AI & Humanoid Robotics Textbook with RAG Chatbot

**Feature**: 001-ai-textbook-rag-chatbot
**Date**: 2025-12-07

## Entities

### Textbook Chapter

Represents a chapter in the Physical AI & Humanoid Robotics textbook.

- **id**: Unique identifier (UUID)
- **title**: Title of the chapter (string, required)
- **content**: Full markdown content of the chapter (text, required)
- **slug**: URL-friendly identifier (string, required, unique)
- **order**: Display order in the textbook (integer, required)
- **section**: Which section of the textbook this chapter belongs to (string, optional)
- **createdAt**: Timestamp when the chapter was created (datetime, required)
- **updatedAt**: Timestamp when the chapter was last updated (datetime, required)
- **wordCount**: Number of words in the chapter (integer)
- **readingTime**: Estimated reading time in minutes (integer)

**Validation rules**:
- Title must be 1-200 characters
- Content must not be empty
- Slug must be unique and follow URL-friendly format (alphanumeric + hyphens)
- Order must be a positive integer

### Content Block

Represents a segment of content that can be referenced by the RAG system.

- **id**: Unique identifier (UUID)
- **chapterId**: Reference to the parent chapter (UUID, required)
- **type**: Type of content block (string, e.g., "paragraph", "code", "figure", "table")
- **content**: The actual content (text, required)
- **position**: Position within the chapter (integer, required)
- **createdAt**: Timestamp when the block was created (datetime, required)
- **vectorId**: Reference to the vector in Qdrant (string, required)

**Validation rules**:
- ChapterId must reference an existing chapter
- Content must not be empty
- Position must be a non-negative integer

### User Question

Represents a question submitted by a user to the RAG chatbot.

- **id**: Unique identifier (UUID)
- **question**: The text of the user's question (text, required)
- **userId**: Identifier of the user who asked (string, optional)
- **sessionId**: Session identifier for conversation context (string, required)
- **createdAt**: Timestamp when the question was asked (datetime, required)
- **relevantContentIds**: List of content block IDs used in the response (array of UUIDs, optional)

**Validation rules**:
- Question must be 1-1000 characters
- SessionId is required to maintain conversation context

### RAG Response

Represents a response generated by the RAG system to a user question.

- **id**: Unique identifier (UUID)
- **questionId**: Reference to the user question (UUID, required)
- **response**: The text of the response (text, required)
- **sources**: List of content block IDs used as sources (array of UUIDs, required)
- **confidence**: Confidence score of the response (float, 0.0-1.0)
- **createdAt**: Timestamp when the response was generated (datetime, required)
- **feedback**: Optional user feedback on the response quality (string, optional)

**Validation rules**:
- Response must not be empty
- QuestionId must reference an existing question
- At least one source must be provided

### Search Query

Represents a search performed by a user to find content in the textbook.

- **id**: Unique identifier (UUID)
- **query**: The text of the search query (string, required)
- **userId**: Identifier of the user who searched (string, optional)
- **sessionId**: Session identifier (string, required)
- **results**: List of content block IDs matching the query (array of UUIDs, required)
- **createdAt**: Timestamp when the search was performed (datetime, required)

**Validation rules**:
- Query must be 1-500 characters
- Results must not be empty

### User Session

Tracks user sessions for personalization and analytics.

- **id**: Unique identifier (UUID)
- **userId**: Identifier of the user (string, optional)
- **createdAt**: Timestamp when the session started (datetime, required)
- **lastActivityAt**: Timestamp of last activity (datetime, required)
- **isActive**: Whether the session is still active (boolean, default true)

**Validation rules**:
- At least one of userId or session token must be provided